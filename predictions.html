---
layout: default
title: Movie Prediction
permalink: /movie-prediction/
---
<div class="container my-5">
    <div class="card shadow-lg">
        <div class="card-body">
            <h1 class="text-center mb-4">üé• Lights, Camera, Prediction! üé¨</h1>
            <p class="text-center mb-4">
                Ever wondered if your movie idea could charm critics with sky-high ratings?
                Enter the details below, and let‚Äôs see if your blockbuster dreams can come true! üåü
            </p>

            <!-- Movie Prediction Form -->
            <form id="movie-form">
                <h2 class="text-center mb-3">Step Into the Director‚Äôs Chair üé©</h2>
                <!-- Genre -->
                <div class="form-group">
                    <label for="genre">Pick a Genre:</label>
                    <select id="movie-genre" name="movie-genre" class="form-control">
                        <option value="action">Action & Adventure üöÄ</option>
                        <option value="comedy">Comedy üòÇ</option>
                        <option value="drama">Drama üé≠</option>
                        <option value="horror">Horror & Thriller üëª</option>
                        <option value="sciencefiction">Fantasy & Sci-Fi üõ∏</option>
                        <option value="fantasy">Historical üè∞</option>
                        <option value="romance">Romance ‚ù§Ô∏è</option>
                        <option value="crime">Crime üïµÔ∏è‚Äç‚ôÇÔ∏è</option>
                        <option value="musical">Musical üé∂</option>
                        <option value="other">Something Unique ‚ú®</option>
                    </select>
                </div>

                <!-- Release year -->
                <div class="form-group">
                    <label for="release-year">Estimated release year:</label>
                    <input type="number" id="release-year" name="release-year" class="form-control"
                        placeholder="e.g., 2025" required>
                </div>

                <!-- Runtime -->
                <div class="form-group">
                    <label for="runtime">Movie Runtime (in minutes):</label>
                    <input type="number" id="runtime" name="runtime" class="form-control" placeholder="e.g., 120"
                        required>
                </div>

                <!-- Budget -->
                <div class="form-group">
                    <label for="budget">Budget (in $):</label>
                    <input type="number" id="budget" name="budget" class="form-control" placeholder="e.g., 1000000"
                        required>
                </div>

                <!-- Number of Characters -->
                <div class="form-group">
                    <label for="num-characters">How Many Characters Steal the Show?</label>
                    <input type="number" id="num-characters" name="num-characters" class="form-control"
                        placeholder="e.g., 10" required>
                </div>

                <!-- Mean Age of the Actors -->
                <div class="form-group">
                    <label for="mean-age">What‚Äôs the Average Age of Your Cast? (in years):</label>
                    <input type="number" id="mean-age" name="mean-age" class="form-control" placeholder="e.g., 35"
                        required>
                </div>

                <!-- Mean Height of the Actors -->
                <div class="form-group">
                    <label for="mean-height">Average Height of the Cast (in cm):</label>
                    <input type="number" id="mean-height" name="mean-height" class="form-control"
                        placeholder="e.g., 175" required>
                </div>

                <!-- Most Present Ethnicity -->
                <div class="form-group">
                    <label for="main-ethnicity">Most Represented Ethnicity in Your Cast:</label>
                    <select id="main-ethnicity" name="main-ethnicity" class="form-control">
                        <option value="asian">Asian</option>
                        <option value="white">White</option>
                        <option value="african">African</option>
                        <option value="indigenous">Indigenous</option>
                        <option value="hispanic">Hispanic</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <hr class="my-4">

                <!-- Lead Actor 1 -->
                <h3 class="text-center mb-3">Meet Your Star #1 üåü</h3>
                <div class="form-group">
                    <label for="actor-gender-lead-actor1">Their Gender:</label>
                    <select id="actor-gender-lead-actor1" name="actor-gender-lead-actor1" class="form-control">
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="actor-height-lead-actor1">Height (cm):</label>
                    <input type="number" id="actor-height-lead-actor1" name="actor-height-lead-actor1"
                        class="form-control" placeholder="e.g., 175" required>
                </div>

                <div class="form-group">
                    <label for="actor-age-at-release-lead-actor1">Age at Release:</label>
                    <input type="number" id="actor-age-at-release-lead-actor1" name="actor-age-at-release-lead-actor1"
                        class="form-control" placeholder="e.g., 30" required>
                </div>

                <div class="form-group">
                    <label for="actor-ethnicity-lead-actor1">Ethnicity:</label>
                    <select id="actor-ethnicity-lead-actor1" name="actor-ethnicity-lead-actor1" class="form-control"
                        required>
                        <option value="asian">Asian</option>
                        <option value="white">White</option>
                        <option value="african">African</option>
                        <option value="indigenous">Indigenous</option>
                        <option value="hispanic">Hispanic</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <hr class="my-4">

                <!-- Lead Actor 2 -->
                <h3 class="text-center mb-3">Your Co-Star Joins the Cast üé≠</h3>
                <div class="form-group">
                    <label for="actor-gender-lead-actor2">Their Gender:</label>
                    <select id="actor-gender-lead-actor2" name="actor-gender-lead-actor2" class="form-control">
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="actor-height-lead-actor2">Height (cm):</label>
                    <input type="number" id="actor-height-lead-actor2" name="actor-height-lead-actor2"
                        class="form-control" placeholder="e.g., 180" required>
                </div>

                <div class="form-group">
                    <label for="actor-age-at-release-lead-actor2">Age at Release:</label>
                    <input type="number" id="actor-age-at-release-lead-actor2" name="actor-age-at-release-lead-actor2"
                        class="form-control" placeholder="e.g., 28" required>
                </div>

                <div class="form-group">
                    <label for="actor-ethnicity-lead-actor2">Ethnicity:</label>
                    <select id="actor-ethnicity-lead-actor2" name="actor-ethnicity-lead-actor2" class="form-control"
                        required>
                        <option value="asian">Asian</option>
                        <option value="white">White</option>
                        <option value="african">African</option>
                        <option value="indigenous">Indigenous</option>
                        <option value="hispanic">Hispanic</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <!-- Submit Button -->
                <button type="submit" id="sub-button" class="btn btn-lg btn-block mt-4"
                    style="background-color: #404040; color: white;">
                    Predict Your Blockbuster! üöÄ
                </button>
            </form>

            <!-- Prediction Result -->
            <!-- Prediction Result Section -->
            <div class="text-center mt-4 p-4 bg-light rounded shadow-sm">
                <p id="prediction-result" class="h4 font-weight-bold text-dark"></p>
                <p id="prediction-result-status" class="mt-2 text-muted"></p>
            </div>

            <h2>‚ö†Ô∏è Disclaimer</h2>
            <p class="disclaimer">The results of this prediction tool are for informational purposes only and do not
                engage our responsibility. Use the insights with caution! üòä</p>

            <h2>üìä Model Performance</h2>
            <div class="info">
                <p>Our prediction model has an <strong>R¬≤ score of 0.39</strong>. This means the model explains 39% of
                    the variance in box office performance based on the input features.</p>
                <p>While an R¬≤ of 0.39 indicates the model has some predictive power, there are many other factors not
                    captured by the data that influence box office performance. Keep this in mind when interpreting the
                    results! üòä</p>
            </div>

            <h2>üí° Feature Importance</h2>
            <div class="info">
                <p>Our model considers various features to make predictions. The most important ones are:</p>
                <ul>
                    <li><strong>Runtime</strong>: Contributing 16.3% to the prediction.</li>
                    <li><strong>Movie Release Year</strong>: Contributing 13.2%.</li>
                    <li><strong>Mean Age of Characters</strong>: Contributing 7.9%.</li>
                    <li><strong>Budget</strong>: Contributing 7.3%.</li>
                </ul>
                <p>Other factors, like actor demographics and movie genres, also play a role but are less influential.
                    üòä</p>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS (for better interactivity) -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>

<!-- JavaScript to handle form submission and prediction -->
<script>
    document.getElementById('movie-form').addEventListener('submit', function (e) {
        e.preventDefault(); // Prevent the default form submission

        document.getElementById('sub-button').disabled = true;

        document.getElementById('prediction-result').textContent = "üé• Hold on to your popcorn! Your blockbuster prediction is in the works (it may take up to 5 minutes)... üé¨";

        // Gather form data
        const formData = {
            runtime: document.getElementById('runtime').value,
            releaseYear: document.getElementById('release-year').value,
            budget: document.getElementById('budget').value,

            actor1_gender: document.getElementById('actor-gender-lead-actor1').value,
            actor1_height: document.getElementById('actor-height-lead-actor1').value,
            actor1_age: document.getElementById('actor-age-at-release-lead-actor1').value,

            actor2_gender: document.getElementById('actor-gender-lead-actor2').value,
            actor2_height: document.getElementById('actor-height-lead-actor2').value,
            actor2_age: document.getElementById('actor-age-at-release-lead-actor2').value,

            meanAge: document.getElementById('mean-age').value,
            meanHeight: document.getElementById('mean-height').value,
            numCharacters: document.getElementById('num-characters').value,

            is_action: document.getElementById('movie-genre').value == 'action',
            is_comedy: document.getElementById('movie-genre').value == 'comedy',
            is_crime: document.getElementById('movie-genre').value == 'crime',
            is_drama: document.getElementById('movie-genre').value == 'drama',
            is_fantasy: document.getElementById('movie-genre').value == 'fantasy',
            is_historical: document.getElementById('movie-genre').value == 'historical',
            is_horror: document.getElementById('movie-genre').value == 'horror',
            is_music: document.getElementById('movie-genre').value == 'musical',
            is_other: document.getElementById('movie-genre').value == 'other',
            is_romance: document.getElementById('movie-genre').value == 'romance',

            is_actor1_african: document.getElementById('actor-ethnicity-lead-actor1').value == 'african',
            is_actor1_asian: document.getElementById('actor-ethnicity-lead-actor1').value == 'asian',
            is_actor1_hispanic: document.getElementById('actor-ethnicity-lead-actor1').value == 'hispanic',
            is_actor1_indi: document.getElementById('actor-ethnicity-lead-actor1').value == 'indigenous',
            is_actor1_other: document.getElementById('actor-ethnicity-lead-actor1').value == 'other',
            is_actor1_white: document.getElementById('actor-ethnicity-lead-actor1').value == 'white',

            is_actor2_african: document.getElementById('actor-ethnicity-lead-actor2').value == 'african',
            is_actor2_asian: document.getElementById('actor-ethnicity-lead-actor2').value == 'asian',
            is_actor2_hispanic: document.getElementById('actor-ethnicity-lead-actor2').value == 'hispanic',
            is_actor2_indi: document.getElementById('actor-ethnicity-lead-actor2').value == 'indigenous',
            is_actor2_other: document.getElementById('actor-ethnicity-lead-actor2').value == 'other',
            is_actor2_white: document.getElementById('actor-ethnicity-lead-actor2').value == 'white',

            is_mainethni_african: document.getElementById('main-ethnicity').value == 'african',
            is_mainethni_asian: document.getElementById('main-ethnicity').value == 'asian',
            is_mainethni_hispanic: document.getElementById('main-ethnicity').value == 'hispanic',
            is_mainethni_indi: document.getElementById('main-ethnicity').value == 'indigenous',
            is_mainethni_other: document.getElementById('main-ethnicity').value == 'other',
            is_mainethni_white: document.getElementById('main-ethnicity').value == 'white',
        };

        // DISCLAIMER: Hard-coded values taken from the results notebook
        // DISCLAIMER: Should be done with a proper backend, but hard-coded it here due to practical constraints

        const scaler_x = { "mean": [109.69768656716418, 1990.8146766169154, 10702168.089800995, 0.6843283582089552, 1.7570166169154229, 36.198507462686564, 0.5606641123882503, 1.7424408173690933, 34.57854406130268, 35.8619884867322, 1.7506802717900642, 2.9350746268656716], "scale": [28.453079507392495, 18.526026697431128, 23129139.729189236, 0.4647828055769609, 0.09640402005148477, 12.188278267481678, 0.49630622146830455, 0.09832562962405401, 12.044842400232595, 9.915309399809558, 0.07548221179893114, 2.1879392652132] }
        const scaler_y = { "mean": [6.169676616915423], "scale": [1.0544425774572668] }

        // Helper function to scale data
        function scaleData(value, mean, scale) {
            return (value - mean) / scale;
        }

        // Helper function to unscale data
        function unscaleData(value) {
            return value * scaler_y.scale[0] + scaler_y.mean[0];
        }

        // Scale relevant form data
        const scaledFormData = {
            runtime: scaleData(parseFloat(formData.runtime), scaler_x.mean[0], scaler_x.scale[0]),
            releaseYear: scaleData(parseFloat(formData.releaseYear), scaler_x.mean[1], scaler_x.scale[1]),
            budget: scaleData(parseFloat(formData.budget), scaler_x.mean[2], scaler_x.scale[2]),

            actor1_height: scaleData(parseFloat(formData.actor1_height / 100.0), scaler_x.mean[4], scaler_x.scale[4]),
            actor1_age: scaleData(parseFloat(formData.actor1_age), scaler_x.mean[5], scaler_x.scale[5]),

            actor2_height: scaleData(parseFloat(formData.actor2_height / 100.0), scaler_x.mean[7], scaler_x.scale[7]),
            actor2_age: scaleData(parseFloat(formData.actor2_age), scaler_x.mean[8], scaler_x.scale[8]),

            meanAge: scaleData(parseFloat(formData.meanAge), scaler_x.mean[9], scaler_x.scale[9]),
            meanHeight: scaleData(parseFloat(formData.meanHeight / 100.0), scaler_x.mean[10], scaler_x.scale[10]),
            numCharacters: scaleData(parseFloat(formData.numCharacters), scaler_x.mean[11], scaler_x.scale[11]),

            // Map gender to 1 for male, 0 for female
            actor1_gender: scaleData(formData.actor1_gender === 'male' ? 1 : 0, scaler_x.mean[3], scaler_x.scale[3]),
            actor2_gender: scaleData(formData.actor2_gender === 'male' ? 1 : 0, scaler_x.mean[6], scaler_x.scale[6]),

            // Map boolean values to 1 or 0
            is_action: formData.is_action ? 1 : 0,
            is_comedy: formData.is_comedy ? 1 : 0,
            is_crime: formData.is_crime ? 1 : 0,
            is_drama: formData.is_drama ? 1 : 0,
            is_fantasy: formData.is_fantasy ? 1 : 0,
            is_historical: formData.is_historical ? 1 : 0,
            is_horror: formData.is_horror ? 1 : 0,
            is_music: formData.is_music ? 1 : 0,
            is_other: formData.is_other ? 1 : 0,
            is_romance: formData.is_romance ? 1 : 0,

            // Map ethnicity to 1 or 0
            is_actor1_african: formData.is_actor1_african ? 1 : 0,
            is_actor1_asian: formData.is_actor1_asian ? 1 : 0,
            is_actor1_hispanic: formData.is_actor1_hispanic ? 1 : 0,
            is_actor1_indi: formData.is_actor1_indi ? 1 : 0,
            is_actor1_other: formData.is_actor1_other ? 1 : 0,
            is_actor1_white: formData.is_actor1_white ? 1 : 0,

            is_actor2_african: formData.is_actor2_african ? 1 : 0,
            is_actor2_asian: formData.is_actor2_asian ? 1 : 0,
            is_actor2_hispanic: formData.is_actor2_hispanic ? 1 : 0,
            is_actor2_indi: formData.is_actor2_indi ? 1 : 0,
            is_actor2_other: formData.is_actor2_other ? 1 : 0,
            is_actor2_white: formData.is_actor2_white ? 1 : 0,

            is_mainethni_african: formData.is_mainethni_african ? 1 : 0,
            is_mainethni_asian: formData.is_mainethni_asian ? 1 : 0,
            is_mainethni_hispanic: formData.is_mainethni_hispanic ? 1 : 0,
            is_mainethni_indi: formData.is_mainethni_indi ? 1 : 0,
            is_mainethni_other: formData.is_mainethni_other ? 1 : 0,
            is_mainethni_white: formData.is_mainethni_white ? 1 : 0
        };

        console.log(scaledFormData)

        // predict using model
        async function startInference() {
            try {

                document.getElementById('prediction-result-status').textContent = "Status: Trying to fetch the model...";

                // Fetch the model from the URL
                const modelUrl = 'https://mina-tang.github.io/ada-2024-project-authenticdataaddicts/assets/models/random_forest_model.onnx';

                // Fetch the model data
                const modelResponse = await fetch(modelUrl);
                const modelArrayBuffer = await modelResponse.arrayBuffer();

                document.getElementById('prediction-result-status').textContent = "Status: Model fetched, creating the inference session...";

                // Create the inference session with the model data
                const session = await ort.InferenceSession.create(modelArrayBuffer);

                const input = new ort.Tensor(new Float32Array(Object.values(scaledFormData)), [1, 40]);
                const feeds = { float_input: input };

                document.getElementById('prediction-result-status').textContent = "Status: Inference session created, guessing your result...";

                // feed inputs and run
                const results = await session.run(feeds);

                // read from results
                console.log(results)
                document.getElementById('prediction-result-status').textContent = "";
                document.getElementById('prediction-result').textContent = "‚ú® The results are in! Here's how your movie idea measures up: " + unscaleData(results.variable.data[0]);
                document.getElementById('sub-button').disabled = false;

                // unscale the result with scaler_y


            } catch (e) {
                document.getElementById('prediction-result-status').textContent = "";
                document.getElementById('prediction-result').textContent = "üíî Whoops! An error happened during the prediction. Please try again. üéûÔ∏è"

                console.log(`failed to inference ONNX model`);
                console.error(e);
                document.getElementById('sub-button').disabled = false;
            }
        }

        startInference();
    });
</script>